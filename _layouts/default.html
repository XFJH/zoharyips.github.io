<!-- 文章头部 -->
<!DOCTYPE html>
<html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init">
    <head>
        <meta charset="utf-8"/>
        {% seo %}
        {% if page.keywords %}{% assign keywords = page.keywords %}{% else %}{% assign keywords = site.keywords %}{% endif %}
        <meta name="keywords" content="{{ keywords | strip_html | strip_newlines }}" />
        <meta name="og:keywords" content="{{ keywords | strip_html | strip_newlines }}" />
        {% if page.og_image_url %}
        <meta property="og:image" content="{{ page.og_image_url }}" />
        {% else if page.photo_url %}
        <meta property="og:image" content="{{ page.photo_url }}" />
        {% endif %}
        <!-- enforce the IE to use the latest DOM Mode -->
        <meta http-equiv="X-UA-Compatible" content="IE=Edge, chrome=1">
        <!-- forbid the user to zoom the window for the responsive view -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        {% if site.ios_app_name %}
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        {% endif %}
        <link rel="shortcut icon" href="/favicon.ico" />
        <link rel="alternate" type="application/atom+xml" href="/feed.xml" title="{{ site.title }}">
        <link rel="stylesheet" type="text/css" href="/assets/css/global.css">
    </head>
    <body class="{{ page.class }}" data-page="{{ page.class }}">
        <canvas id="zhi-hu-background"></canvas>
        {% include header.html %}
        <div class="main">
            {{ content }}
        </div>
        {% include footer.html %}
    </body>
    <!-- ajax request packing-->
    {%- include js_ajax.html -%}
    <!-- zhihu background base on canvas -->
    {%- include js_zhihu-bg.html -%}
    <!-- fingerprint2 alogrithm -->
    {%- include js_fingerprint2.html -%}
    <!-- hash alogrithm -->
    {%- include js_hash.html -%}
    <script>
        let allAccess = -1;
        let fingerprint = '';
        let ipAddress = '';
        Fingerprint2.get(function (components) {
            fingerprint = hash(JSON.stringify(components));
        });
        ajax({
            method: 'GET',
            url: 'http://47.102.149.103:8080/article/frequency',
            success: function (response) {
                allAccess = response;
            }
        });
        ajax({
            method: 'GET',
            url: 'https://ifconfig.me/ip',
            success: function (response) {
                ipAddress = response;
            }
        });
        ajax({
            method: 'POST',
            url: 'http://47.102.149.103:8080/article/frequency',
            data: {
                'url': window.location.href,
                'title': '{{ page.title }}',
                'fingerprint': fingerprint,
                'ip': ipAddress
            },
            success: function (response) {
                document.getElementById('site-access').innerText = response;
            }
        });
    </script>
</html>